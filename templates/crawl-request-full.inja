<!DOCTYPE html>
<html lang="{{ t.language.code }}" dir="{{ t.language.direction }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ t.meta.title }}</title>
    <meta name="description" content="{{ t.meta.description }}">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="{{ t.meta.title }}">
    <meta property="og:description" content="{{ t.meta.description }}">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="{{ t.language.code }}">
    
    {% if t.language.code == "fa" %}
    <link rel="preload" href="/assets/fonts/vazirmatn/fonts/webfonts/Vazirmatn-FD-Regular.woff2" as="font"
        type="font/woff2" crossorigin>
    <link rel="stylesheet" href="/assets/fonts/vazirmatn/Vazirmatn-FD-font-face.css">
    {% endif %}
    <link rel="stylesheet" href="/css/crawl-request-template.css">
    <style>
        /* Template-specific dynamic styles */
        body {
            direction: {{ t.language.direction }};
        }
        
        /* URL and Email inputs must always be LTR regardless of language */
        .url-input, .email-input {
            direction: ltr !important;
            text-align: left !important;
        }
        
        /* Screen reader only text for accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* RTL-specific adjustments when needed */
        {% if t.language.direction == "rtl" %}
        .language-switcher {
            left: 20px;
            right: auto;
        }
        .slider-value {
            margin-right: 10px;
            margin-left: 0;
        }
        {% endif %}
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button class="theme-toggle-btn" id="theme-toggle" aria-label="Toggle dark mode">
            <svg class="sun-icon" viewBox="0 0 24 24">
                <path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"/>
            </svg>
            <svg class="moon-icon" viewBox="0 0 24 24">
                <path d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z"/>
            </svg>
            <span class="theme-text">üåô</span>
        </button>
    </div>
    
    <!-- Temporarily hidden language switcher
    <div class="language-switcher">
        <label for="language-switcher" class="sr-only">{{ t.language.choose_language }}</label>
        <select id="language-switcher" aria-label="{{ t.language.choose_language }}">
            <option value="en">üá∫üá∏ English</option>
            <option value="fa">üáÆüá∑ ŸÅÿßÿ±ÿ≥€å</option>
        </select>
    </div>
    -->
    
    <div class="container">
        <div class="header">
            <h1>{{ t.header.title }}</h1>
            <p>{{ t.header.subtitle }}</p>
            
            <!-- Sponsor Link -->
            <div class="sponsor-link-container">
                <a href="/sponsor" class="sponsor-link" title="{{ t.sponsor.link_description }}">
                    {{ t.sponsor.link_text }}
                </a>
            </div>
        </div>
        
        <div class="card">
            <!-- Form Section -->
            <div id="form-section">
                <div class="error-message" id="error-message"></div>
                
                <div class="form-section">
                    <h3>{{ t.form.url_section_title }}</h3>
                    <div class="input-group">
                        <label for="url-input">{{ t.form.url_label }}</label>
                        <input type="url" id="url-input" class="url-input" 
                               placeholder="{{ t.form.url_placeholder }}" 
                               value="https://">
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>{{ t.form.crawl_type_title }}</h3>
                    <div class="presets">
                        <div class="preset-card" data-preset="quick">
                            <div class="preset-title">{{ t.presets.quick.title }}</div>
                            <div class="preset-description">{{ t.presets.quick.description }}</div>
                            <div class="preset-specs">{{ t.presets.quick.specs }}</div>
                        </div>
                        <div class="preset-card active" data-preset="standard">
                            <div class="preset-title">{{ t.presets.standard.title }}</div>
                            <div class="preset-description">{{ t.presets.standard.description }}</div>
                            <div class="preset-specs">{{ t.presets.standard.specs }}</div>
                        </div>
                        <div class="preset-card" data-preset="deep">
                            <div class="preset-title">{{ t.presets.deep.title }}</div>
                            <div class="preset-description">{{ t.presets.deep.description }}</div>
                            <div class="preset-specs">{{ t.presets.deep.specs }}</div>
                        </div>
                    </div>
                    
                    <div class="custom-toggle">
                        <button class="toggle-btn" id="custom-settings-toggle">
                            {{ t.form.custom_settings }}
                        </button>
                    </div>
                    
                    <div class="custom-settings" id="custom-settings">
                        <div class="slider-group">
                            <label>{{ t.form.max_pages_label }}: <span class="slider-value" id="pages-value">50</span></label>
                            <input type="range" id="pages-slider" class="slider" 
                                   min="5" max="500" value="50">
                        </div>
                        <div class="slider-group">
                            <label>{{ t.form.crawl_depth_label }}: <span class="slider-value" id="depth-value">3</span> {{ t.form.depth_levels }}</label>
                            <input type="range" id="depth-slider" class="slider" 
                                   min="1" max="10" value="3">
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <div class="email-section">
                        <label for="email-input">
                            {{ t.form.email_section_title }}
                        </label>
                        <input type="email" id="email-input" class="email-input" 
                               placeholder="{{ t.form.email_placeholder }}">
                        <small class="privacy-note">
                            {{ t.form.email_privacy_note }}
                        </small>
                    </div>
                </div>
                
                <button class="submit-btn" id="start-crawl-btn">
                    {{ t.form.submit_button }}
                </button>
            </div>
            
            <!-- Progress Section -->
            <div id="progress-section" class="progress-section">
                <div class="progress-text" id="progress-text">
                    {{ t.progress.initializing }}
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="estimated-time" id="estimated-time">
                    {{ t.progress.estimated_time }}
                </div>
            </div>
            
            <!-- Results Section -->
            <div id="results-section" class="results-section">
                <div class="success-message">
                    {{ t.results.success_message }}
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="pages-found">0</div>
                        <div class="stat-label">{{ t.results.stats.pages_found }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="links-found">0</div>
                        <div class="stat-label">{{ t.results.stats.links_found }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="images-found">0</div>
                        <div class="stat-label">{{ t.results.stats.images_found }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="time-taken">0</div>
                        <div class="stat-label">{{ t.results.stats.minutes }}</div>
                    </div>
                </div>
                
                <div class="download-section">
                    <h4 class="download-title">{{ t.results.download_title }}</h4>
                    <a href="#" class="download-btn" id="download-json">{{ t.results.download_json }}</a>
                    <a href="#" class="download-btn" id="download-csv">{{ t.results.download_csv }}</a>
                </div>
                
                <button class="submit-btn new-analysis-btn" id="new-analysis-btn">
                    {{ t.results.new_analysis }}
                </button>
            </div>
        </div>
    </div>
    
    <script src="/js/crawl-request-template.js"></script>
     <!-- Template data injection for JavaScript -->
    <script>
        // Theme switching functionality
        (function() {
            const themeToggle = document.getElementById('theme-toggle');
            const sunIcon = document.querySelector('.sun-icon');
            const moonIcon = document.querySelector('.moon-icon');
            const themeText = document.querySelector('.theme-text');
            
            // Get saved theme or default to system preference
            function getInitialTheme() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme) {
                    return savedTheme;
                }
                
                // Check system preference
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    return 'dark';
                }
                return 'light';
            }
            
            // Apply theme
            function applyTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                
                // Update button appearance
                if (theme === 'dark') {
                    themeText.textContent = '‚òÄÔ∏è';
                } else {
                    themeText.textContent = 'üåô';
                }
            }
            
            // Toggle theme
            function toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                applyTheme(newTheme);
            }
            
            // Initialize theme
            const initialTheme = getInitialTheme();
            applyTheme(initialTheme);
            
            // Add event listener
            themeToggle.addEventListener('click', toggleTheme);
            
            // Listen for system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('theme')) {
                    applyTheme(e.matches ? 'dark' : 'light');
                }
            });
        })();
        
        // Initialize template data for external JavaScript
        if (typeof initializeTemplateData === 'function') {
            initializeTemplateData({
                baseUrl: "{{ base_url }}",
                base_url: "{{ base_url }}",
                progressComplete: "{{ t.progress.complete }}",
                errorMessages: {
                    emptyUrl: "{{ t.errors.empty_url }}",
                    invalidUrl: "{{ t.errors.invalid_url }}",
                    crawlFailed: "{{ t.errors.crawl_failed }}",
                    networkError: "{{ t.errors.network_error }}"
                },
                progressMessages: [
                    "{{ t.progress.connecting }}",
                    "{{ t.progress.analyzing }}",
                    "{{ t.progress.discovering }}",
                    "{{ t.progress.crawling }}",
                    "{{ t.progress.processing }}",
                    "{{ t.progress.finalizing }}"
                ]
            });
        }
        
        console.log('Full crawl template loaded successfully!');
        console.log('Language:', '{{ t.language.code }}');
        console.log('Direction:', '{{ t.language.direction }}');
    </script>
</body>
</html>